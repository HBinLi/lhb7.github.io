<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-xxxxxx-xx"></script>
    <script type="text/javascript">
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'UA-xxxxxx-xx');
    </script>
  

  <!-- Baidu Tongji -->
  
    <script type="text/javascript">
      // Originial
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  <!-- Baidu Push -->
  
    <script>
      (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
      })();
    </script>
  

  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

  <meta name="google-site-verification" content="lxDfCplOZbIzjhG34NuQBgu2gdyRlAtMB4utP5AgEBc"/>
  <meta name="baidu-site-verification" content="PpzM9WxOJU"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="It&#39;s an IT blog..."/>
  <meta name="keyword" content="Bin&#39;s Blog"/>
  <link rel="shortcut icon" href="/img/avatar/Bin.jpg"/>

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>

  
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css"/>

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css"/>
    <link rel="stylesheet" href="/css/widget.css"/>
    <link rel="stylesheet" href="/css/rocket.css"/>
    <link rel="stylesheet" href="/css/signature.css"/>
    <link rel="stylesheet" href="/css/catalog.css"/>
    <link rel="stylesheet" href="/css/livemylife.css"/>

    
      <!-- wave start -->
      <link rel="stylesheet" href="/css/wave.css"/>
      <!-- wave end -->
    

    
      <!-- top start (article top hot config) -->
      <link rel="stylesheet" href="/css/top.css"/>
      <!-- top end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/scroll.css"/>
      <!-- ThemeColor end -->
    

    
      <!-- viewer start (Picture preview) -->
      <link rel="stylesheet" href="/css/viewer.min.css"/>
      <!-- viewer end -->
    

    
      <!-- Search start -->
      <link rel="stylesheet" href="/css/search.css"/>
      <!-- Search end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/themecolor.css"/>
      <!-- ThemeColor end -->
    

    

    
      <!-- gitalk start -->
      <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"> -->
      <link rel="stylesheet" href="/css/gitalk.css"/>
      <!-- gitalk end -->
    
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
  href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="http://yoursite-url/2022/01/19/子空间学习(9)-On Regularization and the Prior/">
  <title>
    
      子空间学习(9)-On Regularization and the Prior - Bin&#39;s Blog
    
  </title>
<meta name="generator" content="Hexo 5.4.0"></head>


<!-- hack iOS CSS :active style -->

	<body ontouchstart="" class="body--light body--light">


		<!-- ThemeColor -->
		
		<!-- ThemeColor -->
<style type="text/css">
  .body--light {
    --light-mode: none;
    --dark-mode: block;
  }
  .body--dark {
    --light-mode: block;
    --dark-mode: none;
  }
  i.mdui-icon.material-icons.light-mode {
    display: var(--light-mode);
  }
  i.mdui-icon.material-icons.dark-mode {
    display: var(--dark-mode);
  }
</style>
<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons light-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>
<script>
  //getCookieValue
  function getCookieValue(a) {
    var b = document.cookie.match('(^|[^;]+)\\s*' + a + '\\s*=\\s*([^;]+)');
    return b
      ? b.pop()
      : '';
  }
  let themeMode = 'light';
  if (getCookieValue('sb-color-mode') && (getCookieValue('sb-color-mode') !== themeMode)) {
    let dbody = document.body.classList;
    themeMode === 'dark' ? dbody.remove('body--dark') : dbody.add('body--dark');
  }

  //setCookieValue
  var toggleBtn = document.querySelector(".toggle");
  toggleBtn.addEventListener("click", function () {
    var e = document.body.classList.contains("body--dark");
    var cookieString = e
      ? "dark"
      : "light";
    var exp = new Date();
    exp.setTime(exp.getTime() + 3 * 24 * 60 * 60 * 1000); //3天过期
    document.cookie = "sb-color-mode=" + cookieString + ";expires=" + exp.toGMTString() + ";path=/";
  });
</script>

		

		<!-- Gitter -->
		
		<!-- Gitter -->
<!-- Docs:https://gitter.im/?utm_source=left-menu-logo -->
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'your-community/your-room'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

		

		<!-- Navigation (contains search)-->
		<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">An Ordinary Life</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux: <nav>'s height woule be hold on by its content. so, when navbar scale out, the <nav> will cover tags. also mask any touch event of tags, unfortunately. -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">HOME</a>
          </li>

          
          
          <li>
            <a href="/about/">
              
              ABOUT
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/archive/">
              
              ARCHIVES
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/tags/">
              
              TAGS
              
              
            </a>
          </li>
          
          
          
          
          
          <li>
            <a href="/categories/">
              
              CATEGORIES
              
              
            </a>
          </li>
          
          

          
          <li>
            <a class="popup-trigger">
              <span class="search-icon"></span>SEARCH</a>
          </li>
          

          <!-- LangSelect -->
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>

<script>
  // Drop Bootstarp low-performance Navbar Use customize navbar with high-quality material design animation in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


		<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
		<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    .body--light {
      /* intro-header */
      --intro-header-background-image-url-home: url('/img/header_img/newhome_bg.jpg');
      --intro-header-background-image-url-post: url('/img/header_img/lml_bg.jpg');
      --intro-header-background-image-url-page: url('//img/header_img/lml_bg.jpg');
    }
    .body--dark {
      --intro-header-background-image-url-home: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/newhome_bg.jpg');
      --intro-header-background-image-url-post: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/lml_bg.jpg');
      --intro-header-background-image-url-page: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('//img/header_img/lml_bg.jpg');
    }

    header.intro-header {
       /*post*/
        background-image: var(--intro-header-background-image-url-post);
        /* background-image: url('/img/header_img/lml_bg.jpg'); */
      
    }

    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#Python" title="Python">Python</a>
              
            </div>
            <h1>子空间学习(9)-On Regularization and the Prior</h1>
            <h2 class="subheading">Subspace Learning-On Regularization and the Prior</h2>
            <span class="meta">
              Posted by Mr.Li on
              2022-01-19
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count">11</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">2.6k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- WordCount end -->
            
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



		<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
		<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <blockquote>
<p>子空间学习系列主要讨论从PCA发表开始到2010年中，子空间学习相关论文。本文立足于论文：<strong>Sparse Representation For Computer Vision and</strong><br><strong>Pattern Recognition（2009 CVPR）</strong>，<strong>Robust subspace segmentation by low rank represnetation（2010 ICML）</strong>和<strong>L2graph（2016 TCYB）</strong>。基于此进行概念的梳理和思考，尝试从数学的角度去阐述正则化中的一些先验。</p>
</blockquote>
<h1 id="摘要："><a href="#摘要：" class="headerlink" title="摘要："></a>摘要：</h1><p>子空间聚类是传统聚类的扩展，旨在在数据集中的不同子空间中找到聚类。 通常在高维数据中，许多维度是不相关的，并且可以掩盖噪声数据中的现有聚类。 特征选择通过分析整个数据集去除不相关和冗余的维度。 在介绍子空间聚类算法之前，我们先探讨 L1-norm、L2-norm 和核范数。 此外，本报告对子空间聚类算法进行了调查，例如稀疏子空间聚类 (SSC)、低秩表示 (LRR) 和 L2graph。 然后，我们使用经验可扩展性和准确性测试比较了子空间聚类的三种主要方法。本文的解释会比较简略只提重点部分。需要注意的是本文有下划线的部分是一些需要了解的基础概念，由于篇幅，我就不在后面解释，望读者自行查阅。</p>
<h1 id="On-Regularization-and-the-Prior"><a href="#On-Regularization-and-the-Prior" class="headerlink" title="On Regularization and the Prior"></a>On Regularization and the Prior</h1><h2 id="从概率的角度解释-l-1-和-l-2-范数"><a href="#从概率的角度解释-l-1-和-l-2-范数" class="headerlink" title="从概率的角度解释$l_{1}$和$l_{2}$范数"></a>从概率的角度解释$l_{1}$和$l_{2}$范数</h2><p>这里主要推导线性回归的概率解释，然后给出$l_{1}$和$l_{2}$范数在线性回归上的概率解释，只给证明：</p>
<p>我们推导出线性回归的概率解释。 有两个假设：$\epsilon$ 的下划线概率分布是一个高斯分布，我们可以在 $\theta$ 上指定一个先验分布 $p(\theta)$。</p>
<p>让我们进一步假设 $y$ 可以分解为两个项，</p>
<script type="math/tex; mode=display">
y=\theta^{T}x+\epsilon</script><p>其中$\epsilon$ 是解释噪声或未建模因子的误差项。如果$\epsilon$ 的先验概率分布是一个高斯分布，那么我们将有</p>
<script type="math/tex; mode=display">
p(\varepsilon)=\frac{1}{\sqrt{2 \pi} \sigma} \exp (\frac{-(\varepsilon)^{2}}{2 \sigma^{2}}）。</script><p>为了计算 $\theta$ 或 $\hat{\theta}$ 的估计，我们使用最大似然估计，</p>
<script type="math/tex; mode=display">
\hat{\theta}_{M L}=\arg \max _{\theta} L(\theta),</script><p>其中 $L(\theta) \equiv p(y \mid x ; \theta)$ 是似然函数。然后我们有，</p>
<script type="math/tex; mode=display">
p(y \mid x ; \theta)=\frac{1}{\sqrt{2 \pi} \sigma} \exp \left(\frac{-\left(y-\theta^{T} x\right )^{2}}{2 \sigma^{2}}\right),</script><p>似然函数将是，</p>
<script type="math/tex; mode=display">
L(\theta) \equiv p(y \mid x ; \theta)=\Pi_{i=1}^{N} p(y^{(i)} \mid x^{(i)} ; \theta）</script><script type="math/tex; mode=display">
=\Pi_{i=i}^{N} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(\frac{-\left(y^{(i)}-\theta ^{T} x^{(i)}\right)^{2}}{2 \sigma^{2}}\right),</script><p>和对数似然$\ell(\theta)$，</p>
<script type="math/tex; mode=display">
\ell(\theta) \equiv \log L(\theta)=N \log \frac{1}{\sqrt{2 \pi} \sigma}-\frac{1}{\sigma^{2}} \ frac{1}{2} \sum_{i=1}^{N}\left(y^{(i)}-\theta^{T} x^{(i)}\right)^{2} 。</script><p>此外，我们可以很容易地看到最大化 $\ell(\theta)$ 等价于最小化</p>
<script type="math/tex; mode=display">
J(\theta)=\sum_{i=1}^{N}\left(y^{(i)}-\theta^{T} x^{(i)}\right)^{2}，</script><p>这给了我们熟悉的最小二乘成本函数。<br>综上所述，在对误差项$\varepsilon$ 的概率假设下，我们发现使用最小二乘回归模型求$\hat{\varepsilon}$ 等价于求$\varepsilon$ 的最大似然估计。</p>
<h3 id="l-2-范数在线性回归上的概率解释"><a href="#l-2-范数在线性回归上的概率解释" class="headerlink" title="$l_{2}$范数在线性回归上的概率解释"></a>$l_{2}$范数在线性回归上的概率解释</h3><p>给定一个数据集 $S=\left\{\left(x^{(i)}, y^{(i)}\right)_{i=1}^{N}\right\}$，我们打算根据当前观察找到最可能的 $\theta$，即</p>
<script type="math/tex; mode=display">
\hat{\theta}_{MA P}=\arg \max _{\theta} p(\theta \mid S),</script><p>其中 $p(\theta \mid S)$ 是后验概率分布，这样的估计量 $\hat{\theta}_{M A P}$ 也称为 $\theta$ 的 MAP（最大后验）估计量。<br>通过应用贝叶斯定理，我们可以得到</p>
<script type="math/tex; mode=display">
p(\theta \mid S) \propto p(S \mid \theta) p(\theta),</script><p>所以最大化 $p(\theta \mid S)$ 等价于最大化 $p(S \mid \theta) p(\theta)$。因此，我们会有</p>
<script type="math/tex; mode=display">
\hat{\theta}_{MAP}=\arg \max _{\theta} \prod_{i=1}^{N} p\left(y^{(i)} \mid x^{(i) }, \theta\right) p(\theta) 。</script><p>数据是从线性回归模型中提取的，因此 $p(S \mid \theta)$ 等于 $\prod_{i=1}^{N} p\left(y^{(i)} \mid x^{ (i)}\right)$。如果我们假设$p(\theta)$的概率分布是一个多元高斯分布，即$p(\theta) \sim N\left(0, \mathbf{I} \sigma^{2} / \lambda \right)$，我们将有</p>
<script type="math/tex; mode=display">
\hat{\theta}_{MA P}=\arg \max _{\theta} Q(\theta)=\arg \max _{\theta} q(\theta),</script><script type="math/tex; mode=display">
\begin{gathered}
Q(\theta) \equiv\left(\prod_{i=1}^{N} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(\frac{-\left(y ^{(i)}-\theta^{T} x^{(i)}\right)^{2}}{2 \sigma^{2}}\right)\right) \sqrt{\frac{\ lambda}{2 \pi}} \frac{1}{\sigma} \exp \left(-\frac{\lambda \theta^{T} \theta}{2 \sigma^{2}}\right) \ \
q(\theta)=\log (Q(\theta))。
\end{gathered}</script><p>最大化 $q(\theta)$ 等效于最小化成本函数</p>
<script type="math/tex; mode=display">
J(\theta) \equiv\left[\sum_{i=1}^{N}\left(y^{(i)}-\theta^{T} x^{(i)}\right)^{ 2}\right]+\lambda \theta^{T} \theta 。</script><p>因此，优化问题变为，</p>
<script type="math/tex; mode=display">
\hat{\theta}_{MAP}=\arg \min _{\theta}\left[\sum_{i=1}^{N}\left(y^{(i)}-\theta^{T } x^{(i)}\right)^{2}\right]+\lambda \theta^{T} \theta,</script><p>其中最后一项 $\lambda \theta^{T} \theta=\lambda|\theta|^{2}$ 正是 $l_{2}$ 范数正则化项。</p>
<h3 id="l-1-范数在线性回归上的概率解释"><a href="#l-1-范数在线性回归上的概率解释" class="headerlink" title="$l_{1}$范数在线性回归上的概率解释"></a>$l_{1}$范数在线性回归上的概率解释</h3><p>我们直接从拉普拉斯分布的最大后验估计推导出来，</p>
<script type="math/tex; mode=display">
\begin{gathered}
Q(\theta) \equiv\left(\prod_{i=1}^{N} \frac{1}{\sqrt{2 \pi} \sigma} \exp \left(\frac{-\left(y ^{(i)}-\theta^{T} x^{(i)}\right)^{2}}{2 \sigma^{2}}\right)\right) \prod_{j=1} ^{d}\frac{1}{2b}exp(-\frac{|\theta_{i}|}{b}) \\
q(\theta)=\log (Q(\theta))。
\end{gathered}</script><p>最大化 $q(\theta)$ 等效于最小化成本函数</p>
<script type="math/tex; mode=display">
J(\theta) \equiv\left[\sum_{i=1}^{N}\left(y^{(i)}-\theta^{T} x^{(i)}\right)^{ 2}\right]+\lambda \sum_{j=1}^{d}|\theta_{i}|。</script><p>因此，优化问题变为，</p>
<script type="math/tex; mode=display">
\hat{\theta}_{MAP}=\arg \min _{\theta}\left[\sum_{i=1}^{N}\left(y^{(i)}-\theta^{T } x^{(i)}\right)^{2}\right]+\lambda \|\theta\|,</script><p>其中最后一项 $\lambda |\theta|=\lambda \sum_{j=1}^{d}|\theta_{i}|$ 正是 $l_{1}$ 范数正则化项。</p>
<h1 id="Sparse-Subspace-Clustering"><a href="#Sparse-Subspace-Clustering" class="headerlink" title="Sparse Subspace Clustering"></a>Sparse Subspace Clustering</h1><h2 id="Subspace-Clustering"><a href="#Subspace-Clustering" class="headerlink" title="Subspace Clustering"></a>Subspace Clustering</h2><p>原数据可以由多个子空间中的数据点表示，给定子空间集 $S=[s_{1},\cdots,s_{m}]$ 中的数据点 $X=[x_{1},\cdots,x_{n}]$，任务就是在多个子空间中找到最合适的子空间以及对应的数据点来表示原数据，由此：求子空间的个数$m$，它们的维数$D=[d_{1},\cdot,d_{m}]$，每个子空间的基，以及数据的聚类，见公式(1)：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{gathered}
        F=[f_{1},\cdots,f_{n}]\\
        f_{i}: \ X\rightarrow s_{i} \\ 
        f_{i}(X) \ \in \ \mathcal{R}^{d_{i}\times n}.
    \end{gathered}
\end{equation}\tag{1}</script><h2 id="SSC"><a href="#SSC" class="headerlink" title="SSC"></a>SSC</h2><p>稀疏子空间聚类的动机是直接使用位于子空间联合上的向量的稀疏表示将数据聚类到单独的子空间中。SSC的目标函数是：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{gathered}
        min \|s\|_{p}\\
        \text{s.t. } \textbf{y}=As,
    \end{gathered}
\end{equation}\tag{2}</script><p>其中 $|s|_{p}$ 是 $s$ 的不同范数。 考虑一个向量 $x\in \mathcal{R}^{D}$，它可以表示为 $D$ 个向量 。 如果$\{\phi_{i}\in \mathcal{R}^{D}\}^{D}_{i=1}$我们形成基矩阵 $\Phi= [\phi_{1},\phi_{2},···,\phi_{D}]$，我们可以将 $\textbf{x}$ 写为</p>
<script type="math/tex; mode=display">
\boldsymbol{x}=\sum_{i=1}^{D} s_{i} \boldsymbol{\psi}_{i}=\Psi \boldsymbol{s}，</script><p>其中 $\textbf{s}= [s_{1},s_{2}, . . . , s_{D}]$。 我们对 $i\in \{1,2,\cdots ,m\}$。 因此，</p>
<script type="math/tex; mode=display">
\textbf{y}=[y_{1},y_{2},\cdots,y_{m}]^{T}=\Phi \textbf{x}=\Phi \Psi \textbf{s}=A\textbf{s},</script><p>其中 $\Phi=[\phi_{1},\phi_{2},\cdots,\phi_{m}]^{T}\in \mathcal{R}^{m\times D}$ 称为测量矩阵。此外，SSC 还考虑了从线性或仿射子空间集合中提取的数据点被噪声污染的情况，带噪声的 SSC 的目标函数为公式(3)：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \underset{Z}{\arg \min}\|\textbf{y}-A\textbf{s}\|^{2}+\lambda \|s\|_{p}.
\end{equation}\tag{3}</script><h1 id="Low-Rank-Representation"><a href="#Low-Rank-Representation" class="headerlink" title="Low Rank Representation"></a>Low Rank Representation</h1><p>考虑 $\mathcal{R}^{D}$ 中的一组数据向量 $X= [x_{1}, x_{2},\cdots, x_{n}]$（每列是一个样本），每个样本可以用Dictionary中基的线性组合来表示 $A= [\alpha_{1}, \alpha_{2},···, \alpha_{m}]$: $X=AZ$ ，其中 $Z= [z_{1}, z_{2},\cdots, z_{n}]$ 是系数矩阵，每个 $z_{i}$ 是 $x_{i}$ 的表示。</p>
<p>LRR 的目标函数是公式(4)：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{gathered}
        \min_{Z}\|Z\|_{*}\\
        \text{s.t. }X=AZ,
    \end{gathered}
\end{equation}\tag{4}</script><p>其中 $|\cdot|_{*}$ 表示矩阵的核范数，即矩阵的奇异值之和，用于约束矩阵的低秩。对于稀疏数据，矩阵是低秩的，包含大量冗余信息。此信息可用于恢复数据和提取特征。矩阵 $X$ 的核范数定义为：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \|X\|_{*}=\operatorname{tr}\left(\sqrt{X^{T} X}\right).
\end{equation}\tag{5}</script><p>根据上式，可以得出核范数等价于矩阵的特征值之和。考虑 X $X=U \Sigma V^{T}$ 的特征值分解，可以得出以下结论：</p>
<script type="math/tex; mode=display">
\begin{aligned}
    \operatorname{tr}\left(\sqrt{X^{T} X}\right) &=\operatorname{tr}\left(\sqrt{\left(U \Sigma V^{T}\right)^{T} U \Sigma V^{T}}\right) \\
    &=\operatorname{tr}\left(\sqrt{V \Sigma^{T} U^{T} U \Sigma V^{T}}\right) \\
    &=\operatorname{tr}\left(\sqrt{V \Sigma^{2} V^{T}}\right)\left(\Sigma^{T}=\Sigma\right) \\
    &=\operatorname{tr}\left(\sqrt{V^{T} V \Sigma^{2}}\right) \\
    &=\operatorname{tr}(\Sigma).
    \end{aligned}</script><h1 id="L2graph"><a href="#L2graph" class="headerlink" title="L2graph"></a>L2graph</h1><p>这篇文章主要是在谱聚类的基础上，使用$l_{2}$范数的特征来构建稀疏的相似矩阵。</p>
<p><img src="/2022/01/19/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(9)-On%20Regularization%20and%20the%20Prior/algorithm.png" alt="LLE-Val" style="zoom:90%;"></p>
<center style="color:#C0C0C0;text-decoration:underline">图2. L2graph算法流程。</center>
<img src="/2022/01/19/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(9)-On%20Regularization%20and%20the%20Prior/equation.png" alt="LLE-Val" style="zoom:90%;">

<center style="color:#C0C0C0;text-decoration:underline">图2. 相关公式。</center>

<h1 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h1><p>为了更直观地理解这三种算法，展示一些实验结果，在如下两种数据集上做聚类评估。</p>
<ul>
<li>MNIST：前 2k 个训练图像和前 2k 个测试图像。</li>
<li>耶鲁数据库（$64\times 64$）：包含 15 个人的 165 张 GIF 格式灰度图像，每个对象有 11 张图像。</li>
</ul>
<p>在DUT-OMRON数据集上做分割和去噪实验。</p>
<p><img src="/2022/01/19/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(9)-On%20Regularization%20and%20the%20Prior/Acc.png" alt="LLE-Val" style="zoom:90%;"></p>
<center style="color:#C0C0C0;text-decoration:underline">图1. 聚类效果评估。</center>

<p><img src="/2022/01/19/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(9)-On%20Regularization%20and%20the%20Prior/SSC.png" alt="LLE-Val" style="zoom:90%;"></p>
<center style="color:#C0C0C0;text-decoration:underline">图2. SSC图像分割（二分类）。</center>

<p><img src="/2022/01/19/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(9)-On%20Regularization%20and%20the%20Prior/L2.png" alt="LLE-Val" style="zoom:90%;"></p>
<center style="color:#C0C0C0;text-decoration:underline">图3. L2graph图像分割（二分类）。</center>

<p><img src="/2022/01/19/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(9)-On%20Regularization%20and%20the%20Prior/LRR.png" alt="LLE-Val" style="zoom:90%;"></p>
<p><center style="color:#C0C0C0;text-decoration:underline">图4. LRR图像重建和图像分割。</center><br>代码太多了，我传一下L2graph的Python版代码，SSC和LRR的后续看github放一下吧，这两种算法github也能查到。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> normalize</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Normalization</span>(<span class="params">train_data</span>):</span></span><br><span class="line">    norm_data = normalize(train_data, norm=<span class="string">&#x27;l2&#x27;</span>, axis=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> norm_data</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ClusteringL2Graph</span>(<span class="params">dat, lamda=<span class="number">1e2</span></span>):</span></span><br><span class="line">    pos = <span class="number">0</span></span><br><span class="line">    dat = dat.T</span><br><span class="line">    tmp = dat.T @ dat</span><br><span class="line">    <span class="keyword">if</span> lamda == <span class="number">0</span>:</span><br><span class="line">        Proj_M = np.linalg.pinv(tmp)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        Proj_M = tmp + lamda * np.eye(tmp.shape[<span class="number">0</span>])</span><br><span class="line">        Proj_M = np.linalg.inv(Proj_M)</span><br><span class="line">    Q = Proj_M @ dat.T</span><br><span class="line">    coef = []</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, dat.shape[<span class="number">1</span>]):</span><br><span class="line">        stdOrthbasis = np.zeros((dat.shape[<span class="number">1</span>], <span class="number">1</span>))</span><br><span class="line">        stdOrthbasis[ii] = <span class="number">1</span></span><br><span class="line">        tmp1 = stdOrthbasis.T @ Q @ dat[:, ii]</span><br><span class="line">        tmp2 = np.linalg.pinv(stdOrthbasis.T @ Proj_M @ stdOrthbasis).ravel()</span><br><span class="line">        ci = Proj_M @ ((dat.T @ dat[:, ii]).reshape(dat.shape[<span class="number">1</span>], <span class="number">1</span>) - (tmp1[<span class="number">0</span>] * tmp2[<span class="number">0</span>]) * stdOrthbasis)</span><br><span class="line">        coef.append(ci.tolist())</span><br><span class="line">    coef = np.asarray(coef).reshape(dat.shape[<span class="number">1</span>], dat.shape[<span class="number">1</span>]).T</span><br><span class="line"></span><br><span class="line">    <span class="comment"># l2-norm</span></span><br><span class="line">    coef = coef - np.eye(coef.shape[<span class="number">0</span>]) * coef</span><br><span class="line">    coef = Normalization(coef)</span><br><span class="line">    C = np.<span class="built_in">abs</span>(coef) + np.<span class="built_in">abs</span>(coef)</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"><span class="comment">#test</span></span><br><span class="line"><span class="comment">#C = ClusteringL2Graph(data)</span></span><br><span class="line"><span class="comment">#clustering_L2=SpectralClustering(n_clusters=cluster, affinity=&#x27;precomputed&#x27;)</span></span><br><span class="line"><span class="comment">#pred_label_L2=clustering_L2.fit_predict(C)</span></span><br></pre></td></tr></table></figure>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>算法效果符合预期，文本理解可能还是不太深刻。</p>


        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          <li class="previous">
            <a href="/2022/01/22/子空间学习(10)-t-SNE/" data-toggle="tooltip" data-placement="top" title="子空间学习(10)- t-SNE">&larr; Previous Post</a>
          </li>
          
          
          <li class="next">
            <a href="/2022/01/18/子空间学习(8)-Sparse Representation/" data-toggle="tooltip" data-placement="top" title="子空间学习(8)-Sparse Representation">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <!-- tip -->
<!-- tip start -->
<div class="tip">
  <p>
    
      If you like this blog or find it useful for you, you are welcome to comment on it. You are also welcome to share this blog, so that more people can participate in it. If the images used in the blog infringe your copyright, please contact the author to delete them. Thank you !
    
  </p>
</div>
<!-- tip end -->

        <!-- tip end -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- Docs:https://github.com/overtrue/share.js -->

<div class="social-share" data-initialized="true" data-disabled="tencent ,douban ,qzone ,linkedin ,facebook ,google ,diandian" data-wechat-qrcode-helper="" align="center">
  <ul class="list-inline text-center social-share-ul">
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-twitter">
        <i class="fa fa-twitter fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a class="social-share-icon icon-wechat">
        <i class="fa fa-weixin fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-weibo">
        <i class="fa fa-weibo fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-qq">
        <i class="fa fa-qq fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon" href="mailto:?subject=子空间学习(9)-On Regularization and the Prior&body=Hi,I found this website and thought you might like it http://yoursite-url/2022/01/19/子空间学习(9)-On Regularization and the Prior/">
        <i class="fa fa-envelope fa-1x" aria-hidden="true"></i>
      </a>
    </li>
  </ul>
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

        <!-- Sharing End -->
        
        <hr>

        <!-- comments start -->
        <!-- 1. gitalk comment -->

  <!-- gitalk start -->
  <!-- Docs:https://github.com/gitalk/gitalk/blob/master/readme-cn.md -->

  <div id="gitalk-container"></div>

  
    <!-- <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.js"></script> -->
    <script src="/js/comment/gitalk.js"></script>
  

  <script>
    var gitalk = new Gitalk({
      clientID: '65682c9d7fede4bb7fc5',
      clientSecret: '6b9080be7fdcaae6ae9bbd667c4d2af5f16eb118',
      repo: 'lhb7.github.io',
      owner: 'lhb7',
      admin: 'lhb7',
      id: 'Wed Jan 19 2022 12:24:17 GMT+0800', // Ensure uniqueness and length less than 50
      distractionFreeMode: false, // Facebook-like distraction free mode
      perPage: 10,
      pagerDirection: 'last',
      createIssueManually: true,
      language: 'zh-CN',
      proxy: ''
    });
    gitalk.render('gitalk-container');

    var gtFolded = () => {
      setTimeout(function () {
        let markdownBody = document.getElementsByClassName("markdown-body");
        let list = Array.from(markdownBody);
        list.forEach(item => {
          if (item.clientHeight > 250) {
            item.classList.add('gt-comment-body-folded');
            item.style.maxHeight = '250px';
            item.title = 'Click to Expand';
            item.onclick = function () {
              item.classList.remove('gt-comment-body-folded');
              item.style.maxHeight = '';
              item.title = '';
              item.onclick = null;
            };
          }
        })
      }, 800);
    }
  </script>

  <!-- gitalk end -->


<!-- 2. gitment comment -->


<!-- 3. disqus comment -->


        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%91%98%E8%A6%81%EF%BC%9A"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">摘要：</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#On-Regularization-and-the-Prior"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">On Regularization and the Prior</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E4%BB%8E%E6%A6%82%E7%8E%87%E7%9A%84%E8%A7%92%E5%BA%A6%E8%A7%A3%E9%87%8A-l-1-%E5%92%8C-l-2-%E8%8C%83%E6%95%B0"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">从概率的角度解释$l_{1}$和$l_{2}$范数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#l-2-%E8%8C%83%E6%95%B0%E5%9C%A8%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E4%B8%8A%E7%9A%84%E6%A6%82%E7%8E%87%E8%A7%A3%E9%87%8A"><span class="toc-nav-number">2.1.1.</span> <span class="toc-nav-text">$l_{2}$范数在线性回归上的概率解释</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#l-1-%E8%8C%83%E6%95%B0%E5%9C%A8%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92%E4%B8%8A%E7%9A%84%E6%A6%82%E7%8E%87%E8%A7%A3%E9%87%8A"><span class="toc-nav-number">2.1.2.</span> <span class="toc-nav-text">$l_{1}$范数在线性回归上的概率解释</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Sparse-Subspace-Clustering"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">Sparse Subspace Clustering</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#Subspace-Clustering"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">Subspace Clustering</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#SSC"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">SSC</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Low-Rank-Representation"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">Low Rank Representation</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#L2graph"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">L2graph</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-nav-number">6.</span> <span class="toc-nav-text">实验结果</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-nav-number">7.</span> <span class="toc-nav-text">总结</span></a></li></ol>
        
        </div>
      </aside>
    



      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">FEATURED TAGS</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#Python" title="Python">Python</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>FRIENDS</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://soptq.me/" target="_blank">Soptq</a>
          </li>
          
          <li>
            <a href="http://beantech.org" target="_blank">Bean Tech</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



		<!-- Footer (contains ThemeColor、viewer) -->
		<!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          

          
            <li>
              <a target="_blank" href="https://github.com/lhb7">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

          

          

          
            <li>
              <a target="_blank" href="https://www.zhihu.com/people/BinBin">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa  fa-stack-1x fa-inverse">知</i>
                </span>
              </a>
            </li>
          

          

        </ul>
        <p class="copyright text-muted">
          Copyright &copy;
          Mr.Li
          2022
          <br>
          Theme by
          <a target="_blank" rel="noopener" href="http://beantech.org">BeanTech</a>
          <span style="display: inline-block; margin: 0 5px;">
            <i class="fa fa-heart"></i>
          </span>
          re-Ported by
          <a target="_blank" rel="noopener" href="https://v-vincen.life/">Live My Life</a>
          |
          <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=V-Vincen&repo=V-Vincen.github.io&type=star&count=true"></iframe>
        </p>
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>


  <!-- jQuery -->
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <!-- Bootstrap Core JavaScript -->
  <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  <!-- Custom Theme JavaScript -->
  <script type="text/javascript" src="/js/hux-blog.min.js"></script>
  <!-- catalog -->
  <script async="true" type="text/javascript" src="/js/catalog.js"></script>
  <!-- totop(rocket) -->
  <script async="true" type="text/javascript" src="/js/totop.js"></script>

  

  
    <!-- Scroll start -->
    <script async="async" type="text/javascript" src="/js/scroll.js"></script>
    <!-- Scroll end -->
  

  

  
    <!-- Mouseclick -->
    <script type="text/javascript" src="/js/mouseclick.js" content='The first step is as good as half over...,Laugh and grow fat...,Man proposes God disposes...,When all else is lost the future still remains...,Wasting time is robbing oneself...,Sharp tools make good work...,Cease to struggle and you cease to live...,A friend in need is a friend indeed...,Faith can move mountains...' color='#9933CC,#339933,#66CCCC,#FF99CC,#CCCCFF,#6666CC,#663399,#66CC99,#FF0033'></script>
  

  
    <!-- ribbon -->
    <script type="text/javascript" src="/js/ribbonDynamic.js"></script>
  

  






  <!-- viewer start -->
  <!-- viewer start (Picture preview) -->
  
    <script async="async" type="text/javascript" src="/js/viewer/viewer.min.js"></script>
    <script async="async" type="text/javascript" src="/js/viewer/pic-viewer.js"></script>
  

  <!-- viewer end -->


<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  async ("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async ("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function () { hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if ($('#tag_cloud').length !== 0) { async ("http://yoursite-url/js/jquery.tagcloud.js", function () { $.fn.tagcloud.defaults = { // size: { start: 1, end: 1, unit: 'em' }, color: {
start: '#bbbbee', end: '#0085a1' } }; $('#tag_cloud a').tagcloud(); }) } </script> -->


		<!-- Search -->
		
		<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="SEARCH..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  
    <script src="/js/ziploader.js"></script>
  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;
            


            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


		
	<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


</body>
</html>
