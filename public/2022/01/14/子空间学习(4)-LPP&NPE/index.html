<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-xxxxxx-xx"></script>
    <script type="text/javascript">
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'UA-xxxxxx-xx');
    </script>
  

  <!-- Baidu Tongji -->
  
    <script type="text/javascript">
      // Originial
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  <!-- Baidu Push -->
  
    <script>
      (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
      })();
    </script>
  

  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

  <meta name="google-site-verification" content="lxDfCplOZbIzjhG34NuQBgu2gdyRlAtMB4utP5AgEBc"/>
  <meta name="baidu-site-verification" content="PpzM9WxOJU"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="It&#39;s an IT blog..."/>
  <meta name="keyword" content="Bin&#39;s Blog"/>
  <link rel="shortcut icon" href="/img/avatar/Bin.jpg"/>

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>

  
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css"/>

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css"/>
    <link rel="stylesheet" href="/css/widget.css"/>
    <link rel="stylesheet" href="/css/rocket.css"/>
    <link rel="stylesheet" href="/css/signature.css"/>
    <link rel="stylesheet" href="/css/catalog.css"/>
    <link rel="stylesheet" href="/css/livemylife.css"/>

    
      <!-- wave start -->
      <link rel="stylesheet" href="/css/wave.css"/>
      <!-- wave end -->
    

    
      <!-- top start (article top hot config) -->
      <link rel="stylesheet" href="/css/top.css"/>
      <!-- top end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/scroll.css"/>
      <!-- ThemeColor end -->
    

    
      <!-- viewer start (Picture preview) -->
      <link rel="stylesheet" href="/css/viewer.min.css"/>
      <!-- viewer end -->
    

    
      <!-- Search start -->
      <link rel="stylesheet" href="/css/search.css"/>
      <!-- Search end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/themecolor.css"/>
      <!-- ThemeColor end -->
    

    

    
      <!-- gitalk start -->
      <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"> -->
      <link rel="stylesheet" href="/css/gitalk.css"/>
      <!-- gitalk end -->
    
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
  href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="http://yoursite-url/2022/01/14/子空间学习(4)-LPP&amp;NPE/">
  <title>
    
      子空间学习(4)-LPP&amp;NPE - Bin&#39;s Blog
    
  </title>
<meta name="generator" content="Hexo 5.4.0"></head>


<!-- hack iOS CSS :active style -->

	<body ontouchstart="" class="body--light body--light">


		<!-- ThemeColor -->
		
		<!-- ThemeColor -->
<style type="text/css">
  .body--light {
    --light-mode: none;
    --dark-mode: block;
  }
  .body--dark {
    --light-mode: block;
    --dark-mode: none;
  }
  i.mdui-icon.material-icons.light-mode {
    display: var(--light-mode);
  }
  i.mdui-icon.material-icons.dark-mode {
    display: var(--dark-mode);
  }
</style>
<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons light-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>
<script>
  //getCookieValue
  function getCookieValue(a) {
    var b = document.cookie.match('(^|[^;]+)\\s*' + a + '\\s*=\\s*([^;]+)');
    return b
      ? b.pop()
      : '';
  }
  let themeMode = 'light';
  if (getCookieValue('sb-color-mode') && (getCookieValue('sb-color-mode') !== themeMode)) {
    let dbody = document.body.classList;
    themeMode === 'dark' ? dbody.remove('body--dark') : dbody.add('body--dark');
  }

  //setCookieValue
  var toggleBtn = document.querySelector(".toggle");
  toggleBtn.addEventListener("click", function () {
    var e = document.body.classList.contains("body--dark");
    var cookieString = e
      ? "dark"
      : "light";
    var exp = new Date();
    exp.setTime(exp.getTime() + 3 * 24 * 60 * 60 * 1000); //3天过期
    document.cookie = "sb-color-mode=" + cookieString + ";expires=" + exp.toGMTString() + ";path=/";
  });
</script>

		

		<!-- Gitter -->
		
		<!-- Gitter -->
<!-- Docs:https://gitter.im/?utm_source=left-menu-logo -->
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'your-community/your-room'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

		

		<!-- Navigation (contains search)-->
		<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">An Ordinary Life</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux: <nav>'s height woule be hold on by its content. so, when navbar scale out, the <nav> will cover tags. also mask any touch event of tags, unfortunately. -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">HOME</a>
          </li>

          
          
          <li>
            <a href="/about/">
              
              ABOUT
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/archive/">
              
              ARCHIVES
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/tags/">
              
              TAGS
              
              
            </a>
          </li>
          
          
          
          
          
          <li>
            <a href="/categories/">
              
              CATEGORIES
              
              
            </a>
          </li>
          
          

          
          <li>
            <a class="popup-trigger">
              <span class="search-icon"></span>SEARCH</a>
          </li>
          

          <!-- LangSelect -->
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>

<script>
  // Drop Bootstarp low-performance Navbar Use customize navbar with high-quality material design animation in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


		<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
		<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    .body--light {
      /* intro-header */
      --intro-header-background-image-url-home: url('/img/header_img/newhome_bg.jpg');
      --intro-header-background-image-url-post: url('/img/header_img/lml_bg.jpg');
      --intro-header-background-image-url-page: url('//img/header_img/lml_bg.jpg');
    }
    .body--dark {
      --intro-header-background-image-url-home: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/newhome_bg.jpg');
      --intro-header-background-image-url-post: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/lml_bg.jpg');
      --intro-header-background-image-url-page: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('//img/header_img/lml_bg.jpg');
    }

    header.intro-header {
       /*post*/
        background-image: var(--intro-header-background-image-url-post);
        /* background-image: url('/img/header_img/lml_bg.jpg'); */
      
    }

    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#Python" title="Python">Python</a>
              
            </div>
            <h1>子空间学习(4)-LPP&amp;NPE</h1>
            <h2 class="subheading">Subspace Learning-LPP&amp;NPE</h2>
            <span class="meta">
              Posted by Mr.Li on
              2022-01-14
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count">15</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">3.5k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- WordCount end -->
            
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



		<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
		<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-8 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <blockquote>
<p>子空间学习系列主要讨论从PCA发表开始到2010年中，子空间学习相关论文。本文立足于论文：<strong>Locality Preserving Projections（2004 NIPS）</strong>和<strong>Neighborhood Preserving Embedding（2005 ICCV）</strong>。基于此进行概念的梳理和思考，尝试从数学的角度去阐述LPP和NPE的动机，目标函数和限制等。额，然后本系列的解释应该是中英文混合，私以为用简略的句子生动地描述复杂抽象的概念，需要对算法有着极为深刻的理解和一定的勇气。显然我水平不够，如果强制翻译一些原文的描述和概念，难免不太妥当。</p>
</blockquote>
<h1 id="摘要："><a href="#摘要：" class="headerlink" title="摘要："></a>摘要：</h1><p>信息处理中的许多问题都涉及某种形式的降维。 因此，人们对降维算法很感兴趣。 与旨在保留全局欧几里德结构的主成分分析，我们将介绍两种旨在保留流形上的局部邻域结构的子空间学习算法：邻域保留嵌入（NPE）是局部线性嵌入（LLE）的线性近似，而LPP是拉普拉斯映射（LE）的线性近似。 在本报告中，我们尝试以数学方式解释 NPE 和 LPP 的主要思想，并讨论 PCA、LLE、LE、NPE 和 LPP 之间的区别。本文的解释会比较简略只提重点部分。需要注意的是本文有下划线的部分是一些需要了解的基础概念，由于篇幅，我就不在后面解释，望读者自行查阅。</p>
<h1 id="Method"><a href="#Method" class="headerlink" title="Method"></a>Method</h1><h2 id="假设"><a href="#假设" class="headerlink" title="假设"></a>假设</h2><p>数据点可能位于非线性子流形上，但假设每个局部邻域都是线性的。</p>
<h2 id="解决的问题"><a href="#解决的问题" class="headerlink" title="解决的问题"></a>解决的问题</h2><p>NPE和LPP中每个词的含义可以分别看作三个算法步骤的，这两个算法的很多步骤都是相似的。 更具体地说，流形的“邻域”（Neighborhood，Locality）使我们能够构建邻接图，Perserving的处理是计算权重 $W$，而“嵌入”（Embedding和Projection）则计算投影。</p>
<h2 id="LPP和NPE的算法理解"><a href="#LPP和NPE的算法理解" class="headerlink" title="LPP和NPE的算法理解"></a>LPP和NPE的算法理解</h2><h3 id="构建邻域图"><a href="#构建邻域图" class="headerlink" title="构建邻域图"></a>构建邻域图</h3><p>NPE 和LPP中的“邻域”指的是只有邻域对重建有贡献。</p>
<p>由流形的定义可知，流形中的每一点$X_{a}$在欧氏空间中都有一个邻域$X_{U(a)}$同胚的开集$W_{a}$：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{gathered}
        \forall X_{a} \ \exists X_{U(a)} : \ f(X_{U(a)})\rightarrow W_{a} \ (W_{a} \subseteq \mathbb{R}^{n}) \\
        \forall Y_{a} \ \exists Y_{U(a)} : \ f(Y_{U(a)})\rightarrow W_{a} \ (W_{a} \subseteq \mathbb{R}^{n}),
    \end{gathered}
\end{equation}</script><p>其中 $W_{a}$ 是不变的，$X$ 是高维数据，$Y$ 是低维数据。 更具体地说，NPE 中的“Neighborhood”使用两种方式构建邻接图$G$：</p>
<ul>
<li>$K$ 最近邻（KNN）：如果$x_{j}$ 是$x_{i}$的$k$个最近邻居之一，那么在第$i$个节点和第$j$个节点连一条边。</li>
<li>如果 $|x_{i}-x_{j}|&lt; \epsilon$，则在节点 $i$ 和 $j$ 之间放置一条边。</li>
</ul>
<h3 id="计算邻域矩阵"><a href="#计算邻域矩阵" class="headerlink" title="计算邻域矩阵"></a>计算邻域矩阵</h3><p>这一步中NPE和LPP的做法不同。</p>
<h4 id="NPE计算-W"><a href="#NPE计算-W" class="headerlink" title="NPE计算$W$"></a>NPE计算$W$</h4><p>NPE中的“保留”是指保留流形的局部不变性。 在这一步中，NPE算法尝试计算权重 $W_{ij}$，以每个点的邻域为基础，最好地线性重建每个数据点 $X_{i}$，即最小化线性的重构损失，见公式（1）：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{gathered}
        \arg \min_{W} E(W) = \sum_{i}|X_{i}-\sum_{j}W_{ij}X_{ij}|^2 \\
        \text{ s.t. }\sum_{j}W_{ij}=1,
    \end{gathered}
\end{equation}\tag{1}</script><p>其中 $X_{ij}$ 是 $X_{i}$ 的邻居，$\sum_{j}W_{ij}X_{ij}$ 是局部线性重建。</p>
<p>此外，我们解释为什么我们需要约束 $\sum_{j}W_{ij}=1$。 约束是平移不变性、旋转不变性和伸缩不变性的必要条件。 并且可以通过约束$\sum_{j}W_{ij}=1$的拉格朗日乘子法来最小化重构误差。</p>
<h4 id="LPP计算-W"><a href="#LPP计算-W" class="headerlink" title="LPP计算$W$"></a>LPP计算$W$</h4><p>LPP 中的“保留”是指保留数据集的邻域结构。 更具体地说，数据集的邻域结构可以用线性变换$W$来表示。 在这一步中，我们有两种对边进行加权的方法，即计算权重 $W_{ij}$：</p>
<ul>
<li><p>核函数：如果节点 $i$ 和 $j$ 相连，则放置</p>
<script type="math/tex; mode=display">
     W_{ij}=e^{-\frac{\|x_{i}-x_{j}\|^{2}}{t}}。</script></li>
<li><p>简单连接：$W_{ij}=1$ 当且仅当顶点 $i$ 和 $j$ 由一条边连接。</p>
</li>
</ul>
<h3 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h3><h4 id="NPE计算嵌入"><a href="#NPE计算嵌入" class="headerlink" title="NPE计算嵌入"></a>NPE计算嵌入</h4><p>NPE 中的“嵌入”是指将高维数据点 $X_{i}$ 线性映射到低维嵌入坐标，如公式（2）：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{gathered}
        x_{i}\rightarrow y_{i}=A^{T}x_{i}\\
        A=(a_{0}, a_{1}, \cdots, a_{d-1}),
    \end{gathered}
\end{equation}\tag{2}</script><p>其中 $y_{i}$ 是一个 d 维向量，而 $A$ 是一个 $n\times d$ 矩阵。 同时，列向量$a_{0}、a_{1}、\cdots、a_{d-1}$是公式(3)中分解问题的解。 根据它们的特征值排序，$\lambda_{0}\leq \cdots \leq \lambda_{d-1}$，见公式(3)：</p>
<script type="math/tex; mode=display">
\begin{equation}
    XMX^{T}a=\lambda XX^{T}a,
\end{equation}\tag{3}</script><p>其中 $X=(x_{1},\cdots,x_{m}), M=\left(IW\right)^{T}\left(IW\right), I=diag(1,\cdots,1 )$。</p>
<h4 id="LPP计算映射"><a href="#LPP计算映射" class="headerlink" title="LPP计算映射"></a>LPP计算映射</h4><p>LPP 中的“投影”是指线性投影，它可以最佳地保留流形上高维数据的邻域结构。</p>
<p>投影与公式(2)类似，但获得投影 $A$ 的方式不同。 列向量 $a_{0}, a_{1}, \cdots, a_{d-1}$ 是公式(4)中特征分解问题的解。根据它们的特征值排序，$\lambda_{0}\leq \cdots \leq \lambda_{d-1}$，见公式(4):</p>
<script type="math/tex; mode=display">
\begin{equation}
        XLX^{T}\mathbf{a}=\lambda XDX^{T}\mathbf{a}
\end{equation}\tag{4}</script><p>其中 $D$ ($D_{ii}=\sum_{j}W_{ij}$) 是一个对角矩阵，其条目是 $W$ 的列（或行，因为 $W$ 是对称的）和。 $L=D-W$ 是拉普拉斯矩阵。</p>
<h2 id="具体的推导过程"><a href="#具体的推导过程" class="headerlink" title="具体的推导过程"></a>具体的推导过程</h2><p>在这一部分，我们展示NPE和LPP实现的数学细节。</p>
<h3 id="NPE数学推导"><a href="#NPE数学推导" class="headerlink" title="NPE数学推导"></a>NPE数学推导</h3><p>在 NPE 中，每个数据点都可以表示为其邻居的线性组合。边权可以通过最小化目标目标函数来计算，即最小化重构误差，见等式：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \phi(W)=\sum_{i}\left\|\mathbf{x}_{i}-\sum_{j} W_{i j} \mathbf{x}_{j}\right\|^{2}.
\end{equation}</script><p>设 $\mathbf{y}=\left(y_{1}, y_{2}, \cdots, y_{m}\right)^{T}$ 是这样的映射。选择一个好的映射的合理标准是最小化以下目标函数，见公式(5):</p>
<script type="math/tex; mode=display">
\begin{equation}
    \Phi(\mathbf{y})=\sum_{i}\left(y_{i}-\sum_{j} W_{i j} y_{j}\right)^{2},
\end{equation}\tag{5}</script><p>在适当的约束下。该成本函数基于局部线性重构的误差，但在这里我们在优化坐标 $y_{i}$ 的同时固定权重 $W_{ij}$。假设变换是线性的，即$y^{T}=a^{T}X$，其中$X$的第i列向量为$x_{i}$。我们定义：</p>
<script type="math/tex; mode=display">
z_{i}=y_{i}-\sum_{j}W_{ij}y_{ij},</script><p>同时$z_{i}$可以写成向量形式：</p>
<script type="math/tex; mode=display">
\begin{equation}\nonumber
    \begin{aligned}
        \mathbf{z}&=\mathbf{y}-w\mathbf{y}\\
        &=(I-W)\mathbf{y}.
    \end{aligned}
\end{equation}</script><p>由此目标函数公式(5)可以简化为：</p>
<script type="math/tex; mode=display">
\begin{equation}\nonumber
    \begin{aligned}
        \Phi(\mathbf{y}) &=\sum_{i}\left(y_{i}-\sum_{j} W_{i j} y_{j}\right)^{2} \\
        &=\sum_{i}\left(z_{i}\right)^{2} \\
        &=\mathbf{z}^{T} \mathbf{z} \\
        &=\mathbf{y}^{T}(I-W)^{T}(I-W) \mathbf{y} \\
        &=\mathbf{a}^{T} X(I-W)^{T}(I-W) X^{T} \mathbf{a} \\
        & \doteq \mathbf{a}^{T} X M X^{T} \mathbf{a}
    \end{aligned}
\end{equation}</script><p>其中矩阵 $XMX^{T}$ 是对称和半正定的。为了去除投影中的任意缩放因子，NPE 施加如下约束：</p>
<script type="math/tex; mode=display">
\mathbf{y}^{T} \mathbf{y}=1 \Longrightarrow \mathbf{a}^{T} X X^{T} \mathbf{a}=1.</script><p>最后，最小化问题简化为求解如下问题，</p>
<script type="math/tex; mode=display">
\begin{equation}
    \underset{\mathbf{a}^{T} X X^{T} \mathbf{a}=1}{\arg \underset{\mathbf{a}}{\min}} \mathbf{a}^{T} X M X^{T} \mathbf{a}.
\end{equation}</script><p>然后，我们用拉格朗日乘子法求解上述目标函数，见以下推导：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{aligned}
        f(Y)&=(\textbf{a}^{T}X)M(\textbf{a}^{T}X)^{T} - \lambda(\textbf{a}^{T}X)(\textbf{a}^{T}X)^{T} \\
        \frac{\partial f(Y)}{\partial \textbf{a}}&=2XMX^{T}\textbf{a}-2\lambda XX^{T}\textbf{a}=0 \\
        & \ \ \ \ \ \ X M X^{T} \mathbf{a}=\lambda X X^{T} \mathbf{a}.
    \end{aligned}
\end{equation}</script><p>其中$\textbf{a}$的求解可以用特征值分解或者SVD来求解。</p>
<h3 id="LPP的数学推导"><a href="#LPP的数学推导" class="headerlink" title="LPP的数学推导"></a>LPP的数学推导</h3><p>给定一个数据集，我们构建一个加权图 $G = (V, E)$，其中边将附近的点彼此连接起来。假设图是连通的。设 $Y=[\textbf{y}_{1}, \textbf{y}_{2}, \cdots, \textbf{y}_{n}]$ 是这样的映射，并且 $\textbf{y }=(y_{1}, y_{2}, \cdots, y_{n})^{T}$。然后，我们可以将目标函数转换为半正定二次型的迹作为以下推导，</p>
<script type="math/tex; mode=display">
\begin{equation}\nonumber
    \begin{aligned}
        &\ \ \ \ \sum_{i,j}\|y_{i}-y_{j}\|^{2}W_{ij}=\Phi(Y) \\
        &=\sum_{i=1}^{n}\sum_{j=1}^{n}(y_{i}y_{i}-2y_{i}y_{j}+y_{j}y_{j})W_{ij}\\
        &=2 \sum_{i=1}^{n} D_{i i} y_{i}^{2}-2 \sum_{i=1}^{n} \sum_{j=1}^{n} y_{i} y_{j} W_{i j} \\
        &=2 \operatorname{tr}\left[Y^{T}(D-W) Y\right] \\
        &=2 \operatorname{tr}\left(Y^{T} L Y\right)=2\textbf{y}^{T}L\textbf{y}.
    \end{aligned}
\end{equation}</script><p>在投影中为消除任意缩放因子添加一个约束。因此，目标函数的优化问题可以转化为如下形式：</p>
<script type="math/tex; mode=display">
\begin{equation}\nonumber
    \begin{gathered}
        \arg \min_{Y^{T}}\Phi(Y)=2\textbf{y}^{T}L\textbf{y} \\
        \text{ s.t. } \textbf{y}^{T}D\textbf{y}=1.
    \end{gathered}
\end{equation}\tag{6}</script><p>假设$\textbf{a}$是线性拉普拉斯特征图的变换向量，即$\textbf{y}^{T}=\textbf{a}^{T}X$。公式(6)的最小化问题可以转化为公式：</p>
<script type="math/tex; mode=display">
\begin{equation}
    \underset{(\textbf{a}^{T}X)D(\textbf{a}^{T}X)^{T}=1}{\arg \underset{\textbf{a}}{\min}}=(\textbf{a}^{T}X)L(\textbf{a}^{T}X)^{T}.
\end{equation}</script><p>然后，我们用拉格朗日乘子法求解目标函数，</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{aligned}
        f(Y)&=(\textbf{a}^{T}X)L(\textbf{a}^{T}X)^{T} - \lambda(\textbf{a}^{T}X)D(\textbf{a}^{T}X)^{T} \\
        \frac{\partial f(Y)}{\partial \textbf{a}}&=2XLX^{T}\textbf{a}-2\lambda XDX^{T}\textbf{a} \\
        &=2(L^{\prime} \mathbf{a}-\lambda D^{\prime}\mathbf{a})=0 \\
        & \ \ \ \ \ \ L^{\prime} \mathbf{a}=\lambda D^{\prime}\mathbf{a},
    \end{aligned}
\end{equation}</script><p>其中 $L^{\prime}=X L X^{T}，D^{\prime}=X D X^{T}$。很容易证明矩阵 $D^{\prime}$ 和 $L^{\prime}$ 是对称的和半正定的。求解向量 $\mathbf{a}_{i}(i=1,2, \cdots, k)$ 可以使用特征值分解或SVD进行。</p>
<h2 id="讨论：PCA，LLE，LE，NPE和LPP的区别"><a href="#讨论：PCA，LLE，LE，NPE和LPP的区别" class="headerlink" title="讨论：PCA，LLE，LE，NPE和LPP的区别"></a>讨论：PCA，LLE，LE，NPE和LPP的区别</h2><p>与旨在保留全局欧几里得结构的 PCA 不同，四种降维方法（LLE、LE、NPE 和 LPP）旨在保留局部流形结构。</p>
<p>LLE 和 NPE 都试图通过计算高维数据的低维、邻域保留嵌入来降低平滑流形的维数。LLE 试图发现流形的非线性结构，而 NPE 是 LLE 的线性近似。 所以，NPE 与 LLE 相比有两个优势：</p>
<ul>
<li>与 LLE 相比，NPE 的定义无处不在，而不仅仅是在训练数据点上。 这意味着 NPE 可以在监督或非监督模式下执行。</li>
<li>NPE 是线性的。 这使其快速且适用于实际应用。 它可以在原始空间中进行，也可以在数据点映射到的再现核希尔伯特空间（RKHS）中进行，所以有核NPE。</li>
</ul>
<p>LE 和 LPP 都试图通过使用图拉普拉斯算子之间的对应关系来减少流形的维数，以构建高维空间上的数据在低维流形上的表示。然而，LE 试图发现流形的非线性结构，而 LPP 是非线性 LE 的线性近似。LPP相对于LE的优势类似于NPE相对于LLE的优势。</p>
<p>同时NPE和LPP还是有一些区别的，他们的目标函数完全不同，分别见公式(7)和公式(8):</p>
<script type="math/tex; mode=display">
\begin{equation}
    \begin{aligned}
        \arg \min_{W} E(W) &= \sum_{i}|X_{i}-\sum_{j}W_{ij}X_{ij}|^2 \\
        \arg \min_{Y} \Phi(Y) &= \sum_{i}|Y_{i}-\sum_{j}W_{ij}Y_{ij}|^2 \\
        &=\textbf{y}M\textbf{y}=\textbf{a}^{T}XMX^{T}\textbf{a}\\
    \end{aligned}
\end{equation}\tag{7}</script><script type="math/tex; mode=display">
\begin{equation}
    \begin{gathered}
        \arg \min_{Y^{T}}\sum_{i,j}(y_{i}-y_{j})^{2}W_{ij}=2\textbf{y}^{T}L\textbf{y}=2(\textbf{a}^{T}X)L(\textbf{a}^{T}X)^{T} \\
        \text{ s.t. }(\textbf{a}^{T}X)L(\textbf{a}^{T}X)^{T}=1,\ \textbf{y}^{T}=\textbf{a}^{T}X.
    \end{gathered}
\end{equation}\tag{8}</script><p>$L$ 提供了流形上拉普拉斯贝尔特拉米算子 $\mathcal{L}$ 的离散近似。 因此，矩阵 $M$ 提供了对 $\mathcal{L}^{2}$ 的离散近似。 这表明 NPE 本质上试图找到迭代拉普拉斯算子 $\mathcal{L}^{2}$ 的特征函数的线性近似。 从这个意义上说，NPE 和 LPP 提供了两种不同的方法来线性逼近 Laplace Beltrami 算子的特征函数。</p>
<h2 id="实验效果-MNIST-and-ORL"><a href="#实验效果-MNIST-and-ORL" class="headerlink" title="实验效果(MNIST and ORL)"></a>实验效果(MNIST and ORL)</h2><p>NPE和LPP的代码我自己写的，由粗略实验效果来看，估计有一些问题，也可能是参数没调对。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> kneighbors_graph</span><br><span class="line"><span class="keyword">import</span> scipy</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sparse_max</span>(<span class="params">A, B</span>):</span></span><br><span class="line">    Ag = (A &gt; B).astype(<span class="built_in">int</span>)</span><br><span class="line">    <span class="keyword">return</span> Ag.multiply(A - B) + B</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">NPE</span>(<span class="params">data, train_data, component, neighboor</span>):</span></span><br><span class="line">    W = kneighbors_graph(train_data, neighboor, mode=<span class="string">&#x27;distance&#x27;</span>, include_self=<span class="literal">False</span>)</span><br><span class="line">    W = W.A</span><br><span class="line">    X = train_data.T</span><br><span class="line">    M = (np.eye(X.shape[<span class="number">1</span>]) - W).dot((np.eye(X.shape[<span class="number">1</span>]) - W).T)</span><br><span class="line">    T1 = X.dot(M).dot(X.T)</span><br><span class="line">    T2 = X.dot(X.T)</span><br><span class="line">    T2 = T2 + np.exp(-<span class="number">10</span>) * np.eye(T2.shape[<span class="number">0</span>])</span><br><span class="line">    T = scipy.linalg.inv(T2).dot(T1)</span><br><span class="line">    eigVals, eigVects = np.linalg.eigh(T)  <span class="comment"># 求特征值，特征向量</span></span><br><span class="line">    eigValInd = np.argsort(eigVals)</span><br><span class="line">    eigValInd = eigValInd[<span class="number">0</span>:component]</span><br><span class="line">    w = eigVects[:, eigValInd]</span><br><span class="line">    npe = data.dot(w)</span><br><span class="line">    <span class="keyword">return</span> npe</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">LPP</span>(<span class="params">data, train_data, component, neighboor, t</span>):</span></span><br><span class="line">    W = kneighbors_graph(train_data, neighboor, mode=<span class="string">&#x27;distance&#x27;</span>, include_self=<span class="literal">False</span>)</span><br><span class="line">    W = sparse_max(W, W.T) <span class="comment">#让W矩阵对称，不报warning</span></span><br><span class="line">    W.data[:] = np.exp(-(W.data ** <span class="number">2</span> / (t)))</span><br><span class="line">    W = W.A</span><br><span class="line">    D = np.diag(np.<span class="built_in">sum</span>(W, axis=<span class="number">0</span>))</span><br><span class="line">    L = D - W</span><br><span class="line">    X = train_data.T</span><br><span class="line">    T1 = X.dot(L).dot(X.T)</span><br><span class="line">    T2 = X.dot(D).dot(X.T)</span><br><span class="line">    T2 = T2 + np.exp(-<span class="number">10</span>) * np.eye(T2.shape[<span class="number">0</span>])</span><br><span class="line">    T = scipy.linalg.pinv(T2).dot(T1)</span><br><span class="line">    eigVals, eigVects = np.linalg.eigh(T)  <span class="comment"># 求特征值，特征向量</span></span><br><span class="line">    eigValInd = np.argsort(eigVals)</span><br><span class="line">    eigValInd = eigValInd[<span class="number">0</span>:component]</span><br><span class="line">    w = eigVects[:, eigValInd]</span><br><span class="line">    lpp = data.dot(w)</span><br><span class="line">    <span class="keyword">return</span> lpp</span><br></pre></td></tr></table></figure>
<p>展示一些实验结果，有可视化的降维结果。然后我们在MNIST上，使用PCA，LLE和LE把数据降到2维。</p>
<p><img src="/2022/01/14/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(4)-LPP&NPE/com.png" alt="LLE-Val" style="zoom:72%;"></p>
<center style="color:#C0C0C0;text-decoration:underline">图1. 六种降维算法在MNIST上的效果。</center>

<p>同时我们在MNIST数据集上探究了NPE和LPP算法(<strong>KNN</strong>的$k=1$时)的参数（NPE：邻居$n$，LPP：邻居$n$和参数$t$）变化对效果的影响：</p>
<p><img src="/2022/01/14/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(4)-LPP&NPE/parameter.png" alt="LLE-Val" style="zoom:72%;"></p>
<center style="color:#C0C0C0;text-decoration:underline">图2. 参数对NPE和LPP算法的影响。</center>

<p>然后我们展示算法在ORL数据集上的实验效果。</p>
<p><img src="/2022/01/14/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(4)-LPP&NPE/acc.png" alt="LLE-Val" style="zoom:72%;"></p>
<center style="color:#C0C0C0;text-decoration:underline">图3. ORL数据集上的准确率对比。</center>

<p><img src="/2022/01/14/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(4)-LPP&NPE/face.png" alt="LLE-Val" style="zoom:72%;"></p>
<center style="color:#C0C0C0;text-decoration:underline">图4. ORL数据集上的可视化降维效果。</center>

<p><img src="/2022/01/14/%E5%AD%90%E7%A9%BA%E9%97%B4%E5%AD%A6%E4%B9%A0(4)-LPP&NPE/eig.png" alt="LLE-Val" style="zoom:72%;"></p>
<p><center style="color:#C0C0C0;text-decoration:underline">图5. 算法提取的特征。</center></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>其实在复现过程中，并没有达到论文中的效果，我怀疑是降维算法和分类算法参数的选择并没有使效果达到最优。</p>


        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          <li class="previous">
            <a href="/2022/01/15/子空间学习(5)-GE/" data-toggle="tooltip" data-placement="top" title="子空间学习(5)-GE">&larr; Previous Post</a>
          </li>
          
          
          <li class="next">
            <a href="/2022/01/13/子空间学习(3)-LE/" data-toggle="tooltip" data-placement="top" title="子空间学习(3)-LE">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <!-- tip -->
<!-- tip start -->
<div class="tip">
  <p>
    
      If you like this blog or find it useful for you, you are welcome to comment on it. You are also welcome to share this blog, so that more people can participate in it. If the images used in the blog infringe your copyright, please contact the author to delete them. Thank you !
    
  </p>
</div>
<!-- tip end -->

        <!-- tip end -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- Docs:https://github.com/overtrue/share.js -->

<div class="social-share" data-initialized="true" data-disabled="tencent ,douban ,qzone ,linkedin ,facebook ,google ,diandian" data-wechat-qrcode-helper="" align="center">
  <ul class="list-inline text-center social-share-ul">
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-twitter">
        <i class="fa fa-twitter fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a class="social-share-icon icon-wechat">
        <i class="fa fa-weixin fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-weibo">
        <i class="fa fa-weibo fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-qq">
        <i class="fa fa-qq fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon" href="mailto:?subject=子空间学习(4)-LPP&amp;NPE&body=Hi,I found this website and thought you might like it http://yoursite-url/2022/01/14/子空间学习(4)-LPP&amp;NPE/">
        <i class="fa fa-envelope fa-1x" aria-hidden="true"></i>
      </a>
    </li>
  </ul>
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

        <!-- Sharing End -->
        
        <hr>

        <!-- comments start -->
        <!-- 1. gitalk comment -->

  <!-- gitalk start -->
  <!-- Docs:https://github.com/gitalk/gitalk/blob/master/readme-cn.md -->

  <div id="gitalk-container"></div>

  
    <!-- <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.js"></script> -->
    <script src="/js/comment/gitalk.js"></script>
  

  <script>
    var gitalk = new Gitalk({
      clientID: '65682c9d7fede4bb7fc5',
      clientSecret: '6b9080be7fdcaae6ae9bbd667c4d2af5f16eb118',
      repo: 'lhb7.github.io',
      owner: 'lhb7',
      admin: 'lhb7',
      id: 'Fri Jan 14 2022 12:24:17 GMT+0800', // Ensure uniqueness and length less than 50
      distractionFreeMode: false, // Facebook-like distraction free mode
      perPage: 10,
      pagerDirection: 'last',
      createIssueManually: true,
      language: 'zh-CN',
      proxy: ''
    });
    gitalk.render('gitalk-container');

    var gtFolded = () => {
      setTimeout(function () {
        let markdownBody = document.getElementsByClassName("markdown-body");
        let list = Array.from(markdownBody);
        list.forEach(item => {
          if (item.clientHeight > 250) {
            item.classList.add('gt-comment-body-folded');
            item.style.maxHeight = '250px';
            item.title = 'Click to Expand';
            item.onclick = function () {
              item.classList.remove('gt-comment-body-folded');
              item.style.maxHeight = '';
              item.title = '';
              item.onclick = null;
            };
          }
        })
      }, 800);
    }
  </script>

  <!-- gitalk end -->


<!-- 2. gitment comment -->


<!-- 3. disqus comment -->


        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%91%98%E8%A6%81%EF%BC%9A"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">摘要：</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#Method"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">Method</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%81%87%E8%AE%BE"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">假设</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E8%A7%A3%E5%86%B3%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-nav-number">2.2.</span> <span class="toc-nav-text">解决的问题</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#LPP%E5%92%8CNPE%E7%9A%84%E7%AE%97%E6%B3%95%E7%90%86%E8%A7%A3"><span class="toc-nav-number">2.3.</span> <span class="toc-nav-text">LPP和NPE的算法理解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%9E%84%E5%BB%BA%E9%82%BB%E5%9F%9F%E5%9B%BE"><span class="toc-nav-number">2.3.1.</span> <span class="toc-nav-text">构建邻域图</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E8%AE%A1%E7%AE%97%E9%82%BB%E5%9F%9F%E7%9F%A9%E9%98%B5"><span class="toc-nav-number">2.3.2.</span> <span class="toc-nav-text">计算邻域矩阵</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#NPE%E8%AE%A1%E7%AE%97-W"><span class="toc-nav-number">2.3.2.1.</span> <span class="toc-nav-text">NPE计算$W$</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#LPP%E8%AE%A1%E7%AE%97-W"><span class="toc-nav-number">2.3.2.2.</span> <span class="toc-nav-text">LPP计算$W$</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%98%A0%E5%B0%84"><span class="toc-nav-number">2.3.3.</span> <span class="toc-nav-text">映射</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#NPE%E8%AE%A1%E7%AE%97%E5%B5%8C%E5%85%A5"><span class="toc-nav-number">2.3.3.1.</span> <span class="toc-nav-text">NPE计算嵌入</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#LPP%E8%AE%A1%E7%AE%97%E6%98%A0%E5%B0%84"><span class="toc-nav-number">2.3.3.2.</span> <span class="toc-nav-text">LPP计算映射</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%85%B7%E4%BD%93%E7%9A%84%E6%8E%A8%E5%AF%BC%E8%BF%87%E7%A8%8B"><span class="toc-nav-number">2.4.</span> <span class="toc-nav-text">具体的推导过程</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#NPE%E6%95%B0%E5%AD%A6%E6%8E%A8%E5%AF%BC"><span class="toc-nav-number">2.4.1.</span> <span class="toc-nav-text">NPE数学推导</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#LPP%E7%9A%84%E6%95%B0%E5%AD%A6%E6%8E%A8%E5%AF%BC"><span class="toc-nav-number">2.4.2.</span> <span class="toc-nav-text">LPP的数学推导</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E8%AE%A8%E8%AE%BA%EF%BC%9APCA%EF%BC%8CLLE%EF%BC%8CLE%EF%BC%8CNPE%E5%92%8CLPP%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-nav-number">2.5.</span> <span class="toc-nav-text">讨论：PCA，LLE，LE，NPE和LPP的区别</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%95%88%E6%9E%9C-MNIST-and-ORL"><span class="toc-nav-number">2.6.</span> <span class="toc-nav-text">实验效果(MNIST and ORL)</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">总结</span></a></li></ol>
        
        </div>
      </aside>
    



      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">FEATURED TAGS</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#Python" title="Python">Python</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>FRIENDS</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://soptq.me/" target="_blank">Soptq</a>
          </li>
          
          <li>
            <a href="http://beantech.org" target="_blank">Bean Tech</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



		<!-- Footer (contains ThemeColor、viewer) -->
		<!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          

          
            <li>
              <a target="_blank" href="https://github.com/lhb7">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

          

          

          
            <li>
              <a target="_blank" href="https://www.zhihu.com/people/BinBin">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa  fa-stack-1x fa-inverse">知</i>
                </span>
              </a>
            </li>
          

          

        </ul>
        <p class="copyright text-muted">
          Copyright &copy;
          Mr.Li
          2022
          <br>
          Theme by
          <a target="_blank" rel="noopener" href="http://beantech.org">BeanTech</a>
          <span style="display: inline-block; margin: 0 5px;">
            <i class="fa fa-heart"></i>
          </span>
          re-Ported by
          <a target="_blank" rel="noopener" href="https://v-vincen.life/">Live My Life</a>
          |
          <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=V-Vincen&repo=V-Vincen.github.io&type=star&count=true"></iframe>
        </p>
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>


  <!-- jQuery -->
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <!-- Bootstrap Core JavaScript -->
  <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  <!-- Custom Theme JavaScript -->
  <script type="text/javascript" src="/js/hux-blog.min.js"></script>
  <!-- catalog -->
  <script async="true" type="text/javascript" src="/js/catalog.js"></script>
  <!-- totop(rocket) -->
  <script async="true" type="text/javascript" src="/js/totop.js"></script>

  

  
    <!-- Scroll start -->
    <script async="async" type="text/javascript" src="/js/scroll.js"></script>
    <!-- Scroll end -->
  

  

  
    <!-- Mouseclick -->
    <script type="text/javascript" src="/js/mouseclick.js" content='The first step is as good as half over...,Laugh and grow fat...,Man proposes God disposes...,When all else is lost the future still remains...,Wasting time is robbing oneself...,Sharp tools make good work...,Cease to struggle and you cease to live...,A friend in need is a friend indeed...,Faith can move mountains...' color='#9933CC,#339933,#66CCCC,#FF99CC,#CCCCFF,#6666CC,#663399,#66CC99,#FF0033'></script>
  

  
    <!-- ribbon -->
    <script type="text/javascript" src="/js/ribbonDynamic.js"></script>
  

  






  <!-- viewer start -->
  <!-- viewer start (Picture preview) -->
  
    <script async="async" type="text/javascript" src="/js/viewer/viewer.min.js"></script>
    <script async="async" type="text/javascript" src="/js/viewer/pic-viewer.js"></script>
  

  <!-- viewer end -->


<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  async ("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async ("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function () { hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if ($('#tag_cloud').length !== 0) { async ("http://yoursite-url/js/jquery.tagcloud.js", function () { $.fn.tagcloud.defaults = { // size: { start: 1, end: 1, unit: 'em' }, color: {
start: '#bbbbee', end: '#0085a1' } }; $('#tag_cloud a').tagcloud(); }) } </script> -->


		<!-- Search -->
		
		<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="SEARCH..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  
    <script src="/js/ziploader.js"></script>
  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;
            


            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


		
	<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


</body>
</html>
